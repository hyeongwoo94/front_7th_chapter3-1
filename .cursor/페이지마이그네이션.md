# ManagementPage 마이그레이션 가이드

## 개요

이 문서는 `ManagementPage` 컴포넌트를 레거시 스타일에서 리팩토링된 컴포넌트 규칙에 맞게 마이그레이션한 내용을 설명합니다.

## 마이그레이션 일자

2024년 11월

## 마이그레이션 목표

1. 인라인 스타일을 Tailwind CSS 클래스로 변환
2. 리팩토링된 컴포넌트 시스템 사용 (shadcn/ui 기반)
3. 타입 안정성 개선
4. 코드 일관성 및 유지보수성 향상

## 주요 변경 사항

### 1. 스타일링 마이그레이션

#### Before (인라인 스타일)
```tsx
<div style={{ minHeight: "100vh", background: "#f0f0f0" }}>
  <div style={{ maxWidth: "1200px", margin: "0 auto", padding: "20px" }}>
    <h1 style={{ fontSize: "24px", fontWeight: "bold", marginBottom: "5px", color: "#333" }}>
      관리 시스템
    </h1>
```

#### After (Tailwind CSS)
```tsx
<div className="min-h-screen bg-slate-50">
  <div className="max-w-[1200px] mx-auto p-5">
    <h1 className="text-2xl font-bold mb-1 text-gray-800">
      관리 시스템
    </h1>
```

**변경 사항:**
- `minHeight: "100vh"` → `min-h-screen`
- `background: "#f0f0f0"` → `bg-slate-50`
- `maxWidth: "1200px", margin: "0 auto", padding: "20px"` → `max-w-[1200px] mx-auto p-5`
- 인라인 스타일을 Tailwind 유틸리티 클래스로 변환

### 2. 컴포넌트 구조 개선

#### Before (인라인 버튼)
```tsx
<button
  onClick={() => setEntityType("post")}
  style={{
    padding: "8px 16px",
    marginRight: "5px",
    fontSize: "14px",
    fontWeight: entityType === "post" ? "bold" : "normal",
    border: "1px solid #999",
    background: entityType === "post" ? "#1976d2" : "#f5f5f5",
    color: entityType === "post" ? "white" : "#333",
    cursor: "pointer",
    borderRadius: "3px",
  }}
>
  게시글
</button>
```

#### After (Button 컴포넌트)
```tsx
<Button
  variant={entityType === "post" ? "primary" : "secondary"}
  size="md"
  onClick={() => setEntityType("post")}
>
  게시글
</Button>
```

**변경 사항:**
- 인라인 `<button>` 요소를 리팩토링된 `Button` 컴포넌트로 교체
- 복잡한 인라인 스타일을 `variant`와 `size` props로 단순화
- 일관된 디자인 시스템 적용

### 3. 레이아웃 컴포넌트화

#### Before (인라인 div)
```tsx
<div
  style={{
    background: "white",
    border: "1px solid #ddd",
    padding: "10px",
  }}
>
```

#### After (Card 컴포넌트)
```tsx
<Card variant="default">
```

**변경 사항:**
- 메인 컨테이너를 `Card` 컴포넌트로 감싸기
- 일관된 카드 스타일 적용
- 재사용 가능한 컴포넌트 활용

### 4. 통계 카드 스타일링

#### Before (인라인 스타일)
```tsx
<div
  style={{
    padding: "12px 15px",
    background: "#e3f2fd",
    border: "1px solid #90caf9",
    borderRadius: "3px",
  }}
>
  <div style={{ fontSize: "12px", color: "#666", marginBottom: "4px" }}>
    전체
  </div>
  <div style={{ fontSize: "24px", fontWeight: "bold", color: "#1976d2" }}>
    {stats.total}
  </div>
</div>
```

#### After (Tailwind CSS)
```tsx
<div className="p-3 bg-blue-50 border border-blue-300 rounded-sm">
  <div className="text-xs text-gray-600 mb-1">
    전체
  </div>
  <div className="text-2xl font-bold text-blue-700">
    {stats.total}
  </div>
</div>
```

**변경 사항:**
- 모든 인라인 스타일을 Tailwind 클래스로 변환
- 색상 시스템을 Tailwind의 색상 팔레트로 통일
- 반응형 그리드 레이아웃 유지 (`grid grid-cols-[repeat(auto-fit,minmax(130px,1fr))]`)

### 5. 타입 안정성 개선

#### Before (any 타입 사용)
```tsx
const [formData, setFormData] = useState<any>({});
```

#### After (명시적 타입 정의)
```tsx
type UserFormData = {
  username?: string;
  email?: string;
  role?: "admin" | "moderator" | "user";
  status?: "active" | "inactive" | "suspended";
};

type PostFormData = {
  title?: string;
  content?: string;
  author?: string;
  category?: string;
  status?: "draft" | "published" | "archived";
};

const [userFormData, setUserFormData] = useState<UserFormData>({});
const [postFormData, setPostFormData] = useState<PostFormData>({});
```

**변경 사항:**
- `any` 타입 제거
- 엔티티 타입별로 명시적 타입 정의
- 타입 안정성 향상 및 컴파일 타임 오류 검출 가능

### 6. 폼 필드 타입 안전성

#### Before (타입 캐스팅 없음)
```tsx
<FormSelect
  name="role"
  value={formData.role || "user"}
  onChange={(value) =>
    setFormData({ ...formData, role: value })
  }
```

#### After (타입 캐스팅 적용)
```tsx
<FormSelect
  name="role"
  value={userFormData.role || "user"}
  onChange={(value) =>
    setUserFormData({
      ...userFormData,
      role: value as "admin" | "moderator" | "user",
    })
  }
```

**변경 사항:**
- `FormSelect`의 `onChange`에서 반환되는 `string` 타입을 명시적 타입으로 캐스팅
- 타입 안전성 보장
- 잘못된 값 할당 방지

### 7. 에러 처리 개선

#### Before (any 타입 사용)
```tsx
} catch (error: any) {
  setErrorMessage(error.message || "생성에 실패했습니다");
  setShowErrorAlert(true);
}
```

#### After (타입 안전한 에러 처리)
```tsx
} catch (err) {
  const errorMessage = err instanceof Error ? err.message : "생성에 실패했습니다";
  setErrorMessage(errorMessage);
  setShowErrorAlert(true);
}
```

**변경 사항:**
- `any` 타입 제거
- `instanceof Error` 체크로 타입 안전성 확보
- 명시적 에러 메시지 처리

### 8. useEffect 의존성 배열 개선

#### Before
```tsx
useEffect(() => {
  loadData();
  // ...
}, [entityType]);
```

#### After
```tsx
const loadData = useCallback(async () => {
  // ...
}, [entityType]);

useEffect(() => {
  loadData();
  // ...
}, [entityType, loadData]);
```

**변경 사항:**
- `loadData` 함수를 `useCallback`으로 메모이제이션
- 의존성 배열에 `loadData` 추가하여 React Hook 규칙 준수

## 마이그레이션 체크리스트

- [x] 인라인 스타일을 Tailwind CSS 클래스로 변환
- [x] Button 컴포넌트로 교체
- [x] Card 컴포넌트로 레이아웃 감싸기
- [x] 통계 카드 Tailwind CSS 적용
- [x] 타입 정의 개선 (any 제거)
- [x] userFormData와 postFormData 분리
- [x] 타입 캐스팅 적용
- [x] 에러 처리 개선
- [x] useEffect 의존성 배열 수정
- [x] 린터 오류 해결

## 사용된 컴포넌트

### 리팩토링된 컴포넌트
- `Button` (from `../components/atoms`)
- `Card` (from `../components/organisms`)
- `Alert` (from `../components/organisms`)
- `Table` (from `../components/organisms`)
- `Modal` (from `../components/organisms`)
- `FormInput` (from `../components/molecules`)
- `FormSelect` (from `../components/molecules`)
- `FormTextarea` (from `../components/molecules`)

### 스타일링
- Tailwind CSS 유틸리티 클래스
- shadcn/ui 기반 디자인 시스템

## 주의사항

1. **타입 캐스팅**: `FormSelect`의 `onChange`에서 반환되는 값은 `string` 타입이므로, 명시적 타입 캐스팅이 필요합니다.

2. **FormData 분리**: `userFormData`와 `postFormData`를 분리하여 타입 안정성을 확보했습니다. 각 폼 필드에서 올바른 formData를 사용해야 합니다.

3. **의존성 배열**: `useCallback`을 사용하여 함수를 메모이제이션하고, `useEffect`의 의존성 배열에 포함시켜야 합니다.

## 향후 개선 사항

1. **커스텀 훅 분리**: 폼 로직을 커스텀 훅으로 분리하여 재사용성 향상
2. **폼 검증**: react-hook-form과 zod를 사용한 폼 검증 추가
3. **로딩 상태**: 데이터 로딩 중 로딩 인디케이터 추가
4. **에러 바운더리**: 에러 처리 개선 및 에러 바운더리 추가

## 참고 자료

- [Tailwind CSS 문서](https://tailwindcss.com/docs)
- [shadcn/ui 문서](https://ui.shadcn.com/)
- [React TypeScript 가이드](https://react-typescript-cheatsheet.netlify.app/)

